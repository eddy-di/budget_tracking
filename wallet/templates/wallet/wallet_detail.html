{% extends 'base.html' %}

{% block content %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <h1>Wallet details for {{ wallet.name }}</h1>
      <div class="wallet_info" style="float: left;">
        <p>
            Total expenses: {{ expense_sum }}
        </p>
        <p>
            Total incomes: {{ income_sum }}
        </p>
        {% if difference > 0 %}
          <p style="color: MediumSeaGreen;">
            Difference: {{ difference }}
          </p>
        {% else %}
          <p style="color: tomato;">
            Difference: {{ difference }}
          </p>
        {% endif %}
        <p>
          <a href="{% url 'wallet:expense_list' wallet_id=wallet.id %}">
              Expenses
          </a>
        </p>
        <p>
          <a href="{% url 'wallet:income_list' wallet_id=wallet.id %}">
              Incomes
          </a>
        </p>
      </div>
      <div class="wallet_doughnut_chart_info">
          <canvas id="myChart"></canvas>
      </div>
      <div class="wallet_info">
        <canvas id="myExpensesBarChart"></canvas>
      </div>
      <div class="wallet_info">
        <canvas id="myIncomesBarChart"></canvas>
      </div>
      
    <script>
        const ctx = document.getElementById('myChart');
      
        new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['Expenses', 'Incomes'],
            datasets: [{
              label: 'Total sum',
              data: {{ data|safe }},
              borderWidth: 1,
              backgroundColor: ['#ff7675', '#7bed9f'],
              hoverBackgroundColor: ['#d63031', '#2ed573'],
            }]
          },
          options: {
            plugins: {
              legend: {
                position: 'right'
              }
            }
          }
        });
    </script>

    <script>
      const ctx_1 = document.getElementById('myExpensesBarChart');

      new Chart(ctx_1, {
        type: 'bar',
        data: {
          labels: {{ labels_expenses_category|safe }},
          datasets: [{
            label: 'Expenses',
            data: {{ data_expenses_category|safe }},
            borderWidth: 1,
            backgroundColor: ['#ff7675'],
            hoverBackgroundColor: ['#d63031']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'left',
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      })
    </script>

    <script>
      const ctx_2 = document.getElementById('myIncomesBarChart')

      new Chart(ctx_2, {
        type: 'bar',
        data: {
          labels: {{ labels_incomes_subcategory|safe }},
          datasets: [{
            label: 'Incomes',
            data: {{ data_incomes_subcategory|safe }},
            borderWidth: 1,
            backgroundColor: ['#7bed9f'],
            hoverBackgroundColor: ['#2ed573']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'left',
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      })
    </script>
      
{% endblock %}


